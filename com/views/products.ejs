<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products | Mispot</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <style type="text/css">
      body {
        background-image: url("/dark.jpg");
        background-size: 100%;
      }
      hr {
        margin: 6px;
      }
      progress {
        display: block;
      }
      button {
        margin-left: 8px;
        text-decoration: none;
        color: #753;
        border-collapse: true;
        border: none;
        background-color: transparent;
        resize: none;
        outline: none;
      }
      body {
        background-color: #151515;
        background-repeat: no-repeat;
      }
      nav {
        background: center;
      }
      .col-lg-6 {
        padding-top: 5px;
      }
      #VE1,
      #VE2,
      #VE3,
      #VE4 {
        border: 1px solid limegreen;
      }
      img {
        padding: 10px 10px 10px 10px;
        height: 200px;
        width: auto;
        align-self: center;
      }
    </style>
  </head>
  <body>
    <nav
      class="navbar navbar-expand-lg navbar-light bg-light"
      style="background-color: #e8f6e8 !important"
    >
      <div class="container-fluid">
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarTogglerDemo01"
          aria-controls="navbarTogglerDemo01"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <a
          class="navbar-brand"
          href="https://proxycompany.uc.r.appspot.com/home"
          >Examplee</a
        >
        <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a
                class="nav-link active"
                aria-current="page"
                href="https://proxycompany.uc.r.appspot.com/home"
                >Home</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Messages</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="#">help</a>
            </li>
            <!-- <li class="nav-item">
          <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
        </li> -->
          </ul>
          <b class="" style="color: #1f1f2b; font-size: 1.4em;">Genuinity index : <span id="gi">loading...</span><span id="cgi" style="font-size: 0.7em; "></span></b>
        </div>
      </div>
    </nav>
    <br />
    <div class="container">
      <div class="row" id="prod">
        <!--    <div class="col-4 card"><img src="/backpack.jpg"></div>
			<div class="col-8 card">
			Product : Backpack<br>
			Product Id : 38563
			<div><% if(arr[3]===1) {%>
            <b style="color: green;">VERIFIED</b>
            <progress title="% Matched" id="file4" value=<%= brr[3] %> max="100"> <%=brr[3] %>% </progress>
            <% } %>
            <% if(arr[3]===0) { %>
                <span  style="color: darkred;">NOT VERIFIED</span>
                <div style="position: absolute;   right: 0px; top: 50%; transform: translate(-50%, -50%);"> <button class="btn btn-outline-success" id="VE4" onclick="call3()">VERIFY</button></div>
            <% } %>
            </div>
		</div>
		</div> -->
      </div>
    </div>
    <div id="v"></div>
    <div id="pagereq" ; style="visibility: hidden;"><%=aig%></div>
    <div id="forimg" ; style="visibility: hidden"><%=str%></div>
    <div id="forimg2" ; style="visibility: hidden"><%=str2%></div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script>
      var txt = undefined;
      var prev = undefined;
      const req = new XMLHttpRequest();
      req.onload = function () {
        try {
          txt = this.responseText;
          txt = JSON.parse(txt);
          console.log(txt);
          load();
        } catch (err) {
          console.log(err);
          alert("Unable to fetch data!");
        }
      };

      req.open(
        "GET",
        "https://proxycompany.uc.r.appspot.com/productdata/",
        true
      );
      req.send();
      req.onerror = function () {};
      //end of getting prod arr

      function load() {
        let texttoins = "";
        document.getElementById("gi").innerHTML = txt.genuinityIndex;
        document.getElementById("cgi").innerHTML = "+"+txt.changeingi.toFixed(2);
        document.getElementById("cgi").style.color = txt.colorofgi;
        for (var i = txt.objlist.length - 1; i >= 0; i--) {
          let tx = "ntng";
          if (txt.objver[i] === 0) {
            tx =
              '<div id="forimg1"><span  style="color: darkred;">NOT VERIFIED</span>\
                <div style="position: absolute;   right: 0px; top: 50%; transform: translate(-50%, -50%);"> <button class="btn btn-outline-success" id="VE1" onclick="call(' +
              i +
              ')">VERIFY</button></div></div>';
          } else if (txt.objver[i] === 2) {
            tx =
              '<div id="forimg1"><span  style="color: darkred;">VERIFICATION NOT COMPLETED</span><div><img src = ' +
              txt.verimage[i] +
              '></img></div>\
                <div style="position: absolute;   right: 0px; top: 50%; transform: translate(-50%, -50%);"> <button class="btn btn-outline-success" id="VE1" onclick="call(' +
              i +
              ')">VERIFY</button></div></div>';
          } else {
            tx =
              '<div id="forimg1"><b style="color: green; margin-right: 10px; position: relative;">VERIFIED<img src="/thumbsup.png" style="width: 35px; height: auto; position: absolute; top: -8px;"></b>\
            <progress title="% Matched" id="file1" value=' +
              txt.pers[i] +
              '  max="100"> ' +
              txt.pers[i] +
              "% </progress><div><img src = " +
              txt.verimage[i] +
              "></img></div></div>";
          }
          texttoins =
            texttoins +
            '<div class="col-4 card"><img src="/' +
            txt.objsrc[i] +
            '"></div>\
      <div class="col-8 card">\
      Product : ' +
            txt.objlist[i] +
            "<br>\
      Product Id : " +
            txt.objid[i] +
            tx +
            "\
    </div>";
        }
        document.getElementById("prod").innerHTML = texttoins;
      }

      //end of loading page with products
      var a = [0, 0, 0, 0];
      let imgurl = document.getElementById("forimg").innerHTML;
      let imgurl2 = document.getElementById("forimg2").innerHTML;
      let image = new Image();
      let image2 = new Image();
      image.src = imgurl;
      image2.src = imgurl2;
      document.getElementById("forimg1").appendChild(image);
      document.getElementById("forimg22").appendChild(image2);
      function call(i) {
        {
          // (`https://proxycompany.uc.r.appspot.com/verify/0`);
          document.getElementById("v").innerHTML =
            '\
          <form id="formid"; action="https://proxycompany.uc.r.appspot.com/verify/' +
            i +
            '" method="get"></form>';
          document.getElementById("formid").submit(function (e) {
            e.preventDefault();
          });
          // setInterval(fst,100);
          a[0] = 1;
        }
      }
      function call1() {
        document.getElementById("VE2").innerHTML =
          '\
          <form id="formid"; action="https://proxycompany.uc.r.appspot.com/verify/1" method="get"></form>';
        document.getElementById("formid").submit(function (e) {
          e.preventDefault();
        });
      }
      function call2() {
        document.getElementById("VE3").innerHTML =
          '\
          <form id="formid"; action="https://proxycompany.uc.r.appspot.com/verify/2" method="get"></form>';
        document.getElementById("formid").submit(function (e) {
          e.preventDefault();
        });
      }
      function call3() {
        document.getElementById("VE4").innerHTML =
          '\
          <form id="formid"; action="https://proxycompany.uc.r.appspot.com/verify/2" method="get"></form>';
        document.getElementById("formid").submit(function (e) {
          e.preventDefault();
        });
      }
      function fst() {
        console.log("rinaog");
        var ag = document.getElementById("pagereq").innerHTML;
        if (ag == "failed") console.log("fiale");
        else if (ag != "undefined") {
          location.replace(ag);
        }
      }
    </script>
  </body>
</html>
